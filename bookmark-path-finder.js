javascript:(function(){(async function(){var MAX_CONCURRENCY=8,TIMEOUT_MS=8000,MAX_TEXT_SIZE=2000000,EXCLUDE_EXT=/\.(png|jpe?g|gif|webp|svg|ico|woff2?|ttf|otf|eot|mp4|mp3|pdf)(\?|#|$)/i;var old=document.getElementById("__path_scanner_panel__");if(old)old.remove();var panel=document.createElement("div");panel.id="__path_scanner_panel__";panel.style.cssText="position:fixed;inset:auto 12px 12px 12px;max-height:55vh;background:#0b0f14;color:#e6edf3;z-index:999999;border:1px solid rgba(255,255,255,.12);border-radius:14px;box-shadow:0 18px 50px rgba(0,0,0,.55);font:13px/1.4 system-ui,-apple-system,Segoe UI,Roboto,Arial;overflow:hidden;";panel.innerHTML='<div style="display:flex;gap:10px;align-items:center;justify-content:space-between;padding:12px 14px;border-bottom:1px solid rgba(255,255,255,.08);"><div style="display:flex;flex-direction:column;gap:2px;"><div style="font-weight:700;font-size:14px;">\uD83D\uDD0E Bookmark Path Finder</div><div id="__ps_status__" style="opacity:.8;font-size:12px;">Starting\u2026</div></div><div style="display:flex;gap:8px;align-items:center;"><button id="__ps_copy__" style="cursor:pointer;padding:7px 10px;border-radius:10px;border:1px solid rgba(255,255,255,.16);background:rgba(255,255,255,.06);color:#e6edf3;">Copy</button><button id="__ps_close__" style="cursor:pointer;padding:7px 10px;border-radius:10px;border:1px solid rgba(255,255,255,.16);background:rgba(255,255,255,.06);color:#e6edf3;">Close</button></div></div><div style="padding:12px 14px;display:grid;grid-template-columns:repeat(4,minmax(0,1fr));gap:10px;border-bottom:1px solid rgba(255,255,255,.08);"><div style="padding:10px;border-radius:12px;background:rgba(255,255,255,.04);border:1px solid rgba(255,255,255,.06);"><div style="opacity:.75;font-size:12px;">Resources</div><div id="__ps_res__" style="font-weight:800;font-size:18px;">0</div></div><div style="padding:10px;border-radius:12px;background:rgba(255,255,255,.04);border:1px solid rgba(255,255,255,.06);"><div style="opacity:.75;font-size:12px;">Fetched OK</div><div id="__ps_ok__" style="font-weight:800;font-size:18px;">0</div></div><div style="padding:10px;border-radius:12px;background:rgba(255,255,255,.04);border:1px solid rgba(255,255,255,.06);"><div style="opacity:.75;font-size:12px;">Failed</div><div id="__ps_fail__" style="font-weight:800;font-size:18px;">0</div></div><div style="padding:10px;border-radius:12px;background:rgba(255,255,255,.04);border:1px solid rgba(255,255,255,.06);"><div style="opacity:.75;font-size:12px;">Unique Paths</div><div id="__ps_paths__" style="font-weight:800;font-size:18px;">0</div></div></div><div style="padding:10px 14px;display:flex;gap:10px;align-items:center;border-bottom:1px solid rgba(255,255,255,.08);"><input id="__ps_search__" placeholder="Filter paths\u2026 (/api, .js, assets\u2026)" style="flex:1;min-width:0;padding:9px 10px;border-radius:12px;border:1px solid rgba(255,255,255,.14);background:rgba(255,255,255,.06);color:#e6edf3;outline:none;"><div style="display:flex;gap:6px;"><button class="__ps_tab__" data-tab="all" style="cursor:pointer;padding:8px 10px;border-radius:12px;border:1px solid rgba(255,255,255,.16);background:rgba(255,255,255,.12);color:#e6edf3;">All</button><button class="__ps_tab__" data-tab="api" style="cursor:pointer;padding:8px 10px;border-radius:12px;border:1px solid rgba(255,255,255,.16);background:rgba(255,255,255,.06);color:#e6edf3;">API</button><button class="__ps_tab__" data-tab="assets" style="cursor:pointer;padding:8px 10px;border-radius:12px;border:1px solid rgba(255,255,255,.16);background:rgba(255,255,255,.06);color:#e6edf3;">Assets</button><button class="__ps_tab__" data-tab="imports" style="cursor:pointer;padding:8px 10px;border-radius:12px;border:1px solid rgba(255,255,255,.16);background:rgba(255,255,255,.06);color:#e6edf3;">Imports</button><button class="__ps_tab__" data-tab="other" style="cursor:pointer;padding:8px 10px;border-radius:12px;border:1px solid rgba(255,255,255,.16);background:rgba(255,255,255,.06);color:#e6edf3;">Other</button></div></div><div style="padding:12px 14px;overflow:auto;max-height:calc(55vh - 176px);"><table style="width:100%;border-collapse:separate;border-spacing:0 8px;"><thead><tr style="text-align:left;opacity:.8;font-size:12px;"><th style="padding:0 10px;">Type</th><th style="padding:0 10px;">Path</th><th style="padding:0 10px;">Source</th></tr></thead><tbody id="__ps_tbody__"></tbody></table><div id="__ps_empty__" style="display:none;opacity:.7;padding:10px;">No results.</div></div>';document.body.appendChild(panel);var statusEl=panel.querySelector("#__ps_status__"),resEl=panel.querySelector("#__ps_res__"),okEl=panel.querySelector("#__ps_ok__"),failEl=panel.querySelector("#__ps_fail__"),pathsEl=panel.querySelector("#__ps_paths__"),tbody=panel.querySelector("#__ps_tbody__"),emptyEl=panel.querySelector("#__ps_empty__"),searchEl=panel.querySelector("#__ps_search__");panel.querySelector("#__ps_close__").onclick=function(){panel.remove();};function classify(path){var p=path.toLowerCase();if(p.indexOf("/api")==0||p.indexOf("/api/")>-1)return"api";if(/\.(png|jpe?g|gif|webp|svg|ico|woff2?|ttf|otf|eot|mp4|mp3|pdf)(\?|#|$)/i.test(p)||p.indexOf("/assets")>-1||p.indexOf("/static")>-1)return"assets";if(/\.(js|mjs|cjs|css|map|json)(\?|#|$)/i.test(p)||p.indexOf("./")==0||p.indexOf("../")==0)return"imports";return"other";}function isLikelyTextResource(url){return url&&!EXCLUDE_EXT.test(url);}function cleanPath(raw){if(!raw)return null;var s=String(raw).trim().replace(/[),;]+$/g,"");if(s.length<2||s.length>300)return null;var ok=s.indexOf("/")==0||s.indexOf("./")==0||s.indexOf("../")==0||s.indexOf("api/")==0||s.indexOf("/api/")>-1;if(!ok)return null;if(/\s/.test(s))return null;return s;}function extractPaths(text){var out=new Set();var m;var reQuoted=/['"]((?:\/|\.\.\/|\.\/)[^'"]{1,300})['"]/g;while((m=reQuoted.exec(text))!==null)out.add(m[1]);var reHttp=/\b(?:fetch|axios\.(?:get|post|put|delete|patch)|\$\.(?:get|post))\s*\(\s*([\'"])(.{1,300}?)\1/g;while((m=reHttp.exec(text))!==null)out.add(m[2]);var reXhr=/\.open\s*\(\s*['"](GET|POST|PUT|DELETE|PATCH)['"]\s*,\s*([\'"])(.{1,300}?)\2/g;while((m=reXhr.exec(text))!==null)out.add(m[3]);var reImport=/\b(?:import\s+(?:[^'"]+\s+from\s+)?|require\s*\()\s*([\'"])(.{1,300}?)\1/g;while((m=reImport.exec(text))!==null)out.add(m[2]);var cleaned=[];out.forEach(function(p){var cp=cleanPath(p);if(cp)cleaned.push(cp);});return cleaned;}function escapeHtml(s){return String(s).replace(/[&<>"']/g,function(x){return({"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#039;"})[x];});}function uniqPush(map,path,source){if(!map.has(path))map.set(path,new Set());map.get(path).add(source);}function render(rows,currentTab,q){tbody.innerHTML="";emptyEl.style.display="none";var query=(q||"").trim().toLowerCase();var filtered=rows;if(currentTab!=="all")filtered=filtered.filter(function(r){return r.type===currentTab;});if(query)filtered=filtered.filter(function(r){return r.path.toLowerCase().indexOf(query)>-1||r.source.toLowerCase().indexOf(query)>-1;});if(!filtered.length){emptyEl.style.display="block";return;}filtered.forEach(function(r){var tr=document.createElement("tr");tr.style.cssText="background:rgba(255,255,255,.04);border:1px solid rgba(255,255,255,.08);";tr.innerHTML='<td style="padding:10px;border-radius:12px 0 0 12px;white-space:nowrap;"><span style="padding:3px 8px;border-radius:999px;border:1px solid rgba(255,255,255,.16);background:rgba(255,255,255,.06);font-size:12px;">'+escapeHtml(r.type.toUpperCase())+'</span></td><td style="padding:10px;word-break:break-word;font-weight:650;">'+escapeHtml(r.path)+'</td><td style="padding:10px;border-radius:0 12px 12px 0;opacity:.85;word-break:break-word;">'+escapeHtml(r.source)+'</td>';tbody.appendChild(tr);});}var currentTab="all",globalRows=[];Array.from(panel.querySelectorAll(".__ps_tab__")).forEach(function(btn){btn.onclick=function(){Array.from(panel.querySelectorAll(".__ps_tab__")).forEach(function(b){b.style.background="rgba(255,255,255,.06)";});btn.style.background="rgba(255,255,255,.12)";currentTab=btn.getAttribute("data-tab");render(globalRows,currentTab,searchEl.value);};});searchEl.oninput=function(){render(globalRows,currentTab,searchEl.value);};panel.querySelector("#__ps_copy__").onclick=async function(){try{var lines=globalRows.map(function(r){return r.type+"\t"+r.path+"\t"+r.source;});await navigator.clipboard.writeText(lines.join("\n"));statusEl.textContent="✅ Copied";setTimeout(function(){statusEl.textContent="Done ✅";},900);}catch(e){alert("Copy failed (clipboard permission denied).");}};function setStatus(msg){statusEl.textContent=msg;}async function fetchText(url){var controller=new AbortController();var timer=setTimeout(function(){controller.abort();},TIMEOUT_MS);try{var r=await fetch(url,{signal:controller.signal,credentials:"include"});if(!r.ok)return{ok:false,text:null};var ct=(r.headers.get("content-type")||"").toLowerCase();if(ct.indexOf("image/")===0||ct.indexOf("font/")===0||ct.indexOf("audio/")===0||ct.indexOf("video/")===0||ct.indexOf("application/pdf")===0)return{ok:false,text:null};var text=await r.text();if(text.length>MAX_TEXT_SIZE)return{ok:false,text:null};return{ok:true,text:text};}catch(e){return{ok:false,text:null};}finally{clearTimeout(timer);}}var resources=performance.getEntriesByType("resource").map(function(r){return r.name;}).filter(Boolean);resEl.textContent=String(resources.length);var pathToSources=new Map();setStatus("Scanning DOM/HTML…");var htmlText=document.documentElement?document.documentElement.outerHTML:"";extractPaths(htmlText).forEach(function(p){uniqPush(pathToSources,p,"DOM/HTML");});var targets=resources.filter(isLikelyTextResource);setStatus("Scanning "+targets.length+" text-like resources…");var okCount=0,failCount=0,idx=0,seenResources=new Set();async function worker(){while(idx<targets.length){var url=targets[idx++];if(seenResources.has(url))continue;seenResources.add(url);var r=await fetchText(url);if(!r.ok||!r.text){failCount++;failEl.textContent=String(failCount);continue;}okCount++;okEl.textContent=String(okCount);extractPaths(r.text).forEach(function(p){uniqPush(pathToSources,p,url);});pathsEl.textContent=String(pathToSources.size);setStatus("OK: "+okCount+", Failed: "+failCount+", Paths: "+pathToSources.size);}}await Promise.all(Array.from({length:Math.min(MAX_CONCURRENCY,targets.length)},function(){return worker();}));var rows=[];pathToSources.forEach(function(sourcesSet,path){var sources=Array.from(sourcesSet);var type=classify(path);var source=(sources.indexOf("DOM/HTML")>-1)?"DOM/HTML":sources[0];if(sources.length>1)source=source+" (+"+(sources.length-1)+")";rows.push({type:type,path:path,source:source});});var order={api:0,assets:1,imports:2,other:3};rows.sort(function(a,b){return(order[a.type]-order[b.type])||a.path.localeCompare(b.path);});globalRows=rows;window.__PATH_SCANNER_RESULTS__=rows;pathsEl.textContent=String(rows.length);setStatus("Done ✅ — Found "+rows.length+" unique paths");render(globalRows,currentTab,"");})();})();
